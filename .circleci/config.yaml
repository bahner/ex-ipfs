version: 1
jobs:
  build: 
    docker:
      - image: circleci/elixir:1.5.2
    working_directory: ~/ipfs_elixir_api
    dependencies: 
      pre: 
        - sh ./script/ci/prepare.sh
      cache_directories:
        - ~/dependencies
        - ~/.mix
        - _build
        - deps
    test: 
      override:
        - sh ./script/ci/tests.sh    
    steps: 
    - checkout
    - run: ./script/ci/prepare.sh
    - run: mix deps.get
    - run: mix test
